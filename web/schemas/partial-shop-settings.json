{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "purchaseOrderWebhook": {
      "type": "object",
      "properties": {
        "endpointUrl": {
          "anyOf": [{ "const": null }, { "type": "string", "minLength": 1 }]
        }
      },
      "required": ["endpointUrl"],
      "additionalProperties": false
    },
    "idFormat": {
      "type": "string",
      "minLength": 1
    },
    "statuses": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "cycleCount": {
      "type": "object",
      "properties": {
        "idFormat": {
          "type": "string",
          "minLength": 1
        },
        "statuses": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          }
        },
        "defaultStatus": {
          "type": "string",
          "minLength": 1
        }
      },
      "required": ["idFormat", "statuses", "defaultStatus"],
      "additionalProperties": false
    },
    "defaultStatus": {
      "type": "string",
      "minLength": 1
    },
    "purchaseOrderIdFormat": {
      "type": "string",
      "minLength": 1
    },
    "purchaseOrderStatuses": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 1
      }
    },
    "defaultPurchaseOrderStatus": {
      "type": "string",
      "minLength": 1
    },
    "stockTransferIdFormat": {
      "type": "string",
      "minLength": 1
    },
    "discountShortcuts": {
      "type": "array",
      "items": {
        "title": "discount-shortcut",
        "$ref": "#/definitions/percentage-or-money"
      }
    },
    "discountRules": {
      "title": "discount-rules",
      "anyOf": [
        { "$ref": "#/definitions/discount-rule-only-allow-shortcuts" },
        { "$ref": "#/definitions/discount-rule-do-not-allow-shortcuts" }
      ]
    },
    "depositShortcuts": {
      "type": "array",
      "items": {
        "title": "deposit-shortcut",
        "$ref": "#/definitions/percentage-or-money"
      }
    },
    "depositRules": {
      "title": "deposit-rules",
      "anyOf": [
        { "$ref": "#/definitions/deposit-rule-only-allow-shortcuts" },
        { "$ref": "#/definitions/deposit-rule-do-not-allow-shortcuts" }
      ]
    },
    "workOrderRequests": {
      "title": "work-order-requests",
      "description": "Settings related to work order requests, where customers can create a work order themselves.",
      "type": "object",
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "enabled": {
              "const": false
            },
            "status": {
              "const": null
            }
          },
          "required": ["enabled", "status"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "enabled": {
              "const": true
            },
            "status": {
              "type": "string"
            }
          },
          "required": ["enabled", "status"],
          "additionalProperties": false
        }
      ]
    },
    "defaultRate": {
      "description": "The default rate used for employees when no rate is specified",
      "$ref": "scalars.json#/definitions/Money"
    },
    "labourLineItemName": {
      "description": "The name of the labour line item that is added to orders",
      "type": "string",
      "minLength": 1
    },
    "labourLineItemSKU": {
      "description": "The SKU of the labour line item that is added to orders",
      "type": "string"
    },
    "chargeSettings": {
      "type": "object",
      "title": "charge-settings",
      "description": "Configuration for charges and specific charge types",
      "properties": {
        "employeeAssignments": {
          "type": "boolean"
        },
        "hourlyLabour": {
          "type": "boolean"
        },
        "fixedPriceLabour": {
          "type": "boolean"
        }
      },
      "required": ["employeeAssignments", "hourlyLabour", "fixedPriceLabour"],
      "additionalProperties": false
    },
    "emailFromTitle": {
      "type": "string"
    },
    "emailReplyTo": {
      "type": "string"
    },
    "printEmail": {
      "type": "string"
    },
    "workOrderPrintTemplates": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "title": "work-order-print-template",
        "properties": {
          "template": {
            "description": "Liquid template used to render a work order printout",
            "type": "string"
          },
          "subject": {
            "description": "Subject used when sending print templates as email. Can include liquid variables.",
            "type": "string"
          }
        },
        "required": ["subject", "template"],
        "additionalProperties": false
      }
    },
    "purchaseOrderPrintTemplates": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "title": "purchase-order-print-template",
        "properties": {
          "template": {
            "description": "Liquid template used to render a work order printout",
            "type": "string"
          },
          "subject": {
            "description": "Subject used when sending print templates as email. Can include liquid variables.",
            "type": "string"
          }
        },
        "required": ["subject", "template"],
        "additionalProperties": false
      }
    },
    "vendorCustomerMetafieldsToShow": {
      "type": "array",
      "items": { "type": "string" }
    }
  },
  "additionalProperties": false,
  "definitions": {
    "percentage-or-money": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "unit": {
              "const": "currency"
            },
            "money": {
              "$ref": "scalars.json#/definitions/Money"
            }
          },
          "required": ["unit", "money"],
          "additionalProperties": false
        },
        {
          "type": "object",
          "properties": {
            "unit": {
              "const": "percentage"
            },
            "percentage": {
              "$ref": "scalars.json#/definitions/Decimal"
            }
          },
          "required": ["unit", "percentage"],
          "additionalProperties": false
        }
      ]
    },
    "percentage-range": {
      "type": "array",
      "items": [{ "$ref": "scalars.json#/definitions/Decimal" }, { "$ref": "scalars.json#/definitions/Decimal" }],
      "minItems": 2,
      "maxItems": 2
    },
    "currency-range": {
      "type": "array",
      "items": [{ "$ref": "scalars.json#/definitions/Money" }, { "$ref": "scalars.json#/definitions/Money" }],
      "minItems": 2,
      "maxItems": 2
    },
    "discount-rule-only-allow-shortcuts": {
      "type": "object",
      "properties": {
        "onlyAllowShortcuts": {
          "const": true
        },
        "allowedPercentageRange": {
          "const": null
        },
        "allowedCurrencyRange": {
          "const": null
        }
      },
      "required": ["onlyAllowShortcuts", "allowedPercentageRange", "allowedCurrencyRange"],
      "additionalProperties": false
    },
    "discount-rule-do-not-allow-shortcuts": {
      "type": "object",
      "properties": {
        "onlyAllowShortcuts": {
          "const": false
        },
        "allowedPercentageRange": {
          "anyOf": [{ "const": null }, { "$ref": "#/definitions/percentage-range" }]
        },
        "allowedCurrencyRange": {
          "anyOf": [{ "const": null }, { "$ref": "#/definitions/currency-range" }]
        }
      },
      "required": ["onlyAllowShortcuts", "allowedPercentageRange", "allowedCurrencyRange"],
      "additionalProperties": false
    },
    "deposit-rule-only-allow-shortcuts": {
      "type": "object",
      "properties": {
        "onlyAllowShortcuts": {
          "const": true
        },
        "onlyAllowHighestAbsoluteShortcut": {
          "type": "boolean",
          "description": "If enabled, only the deposit shortcut that would result in the highest currency amount will be allowed.\n\nExamples with deposit shortcuts of 40% and 100$:\n- an order of 150$ would have a deposit of 100$\n- an order of 1000$ would have a deposit of 400$."
        },
        "allowedPercentageRange": {
          "const": null
        },
        "allowedCurrencyRange": {
          "const": null
        }
      },
      "required": [
        "onlyAllowShortcuts",
        "onlyAllowHighestAbsoluteShortcut",
        "allowedPercentageRange",
        "allowedCurrencyRange"
      ],
      "additionalProperties": false
    },
    "deposit-rule-do-not-allow-shortcuts": {
      "type": "object",
      "properties": {
        "onlyAllowShortcuts": {
          "const": false
        },
        "onlyAllowHighestAbsoluteShortcut": {
          "const": false
        },
        "allowedPercentageRange": {
          "anyOf": [{ "const": null }, { "$ref": "#/definitions/percentage-range" }]
        },
        "allowedCurrencyRange": {
          "anyOf": [{ "const": null }, { "$ref": "#/definitions/currency-range" }]
        }
      },
      "required": [
        "onlyAllowShortcuts",
        "onlyAllowHighestAbsoluteShortcut",
        "allowedPercentageRange",
        "allowedCurrencyRange"
      ],
      "additionalProperties": false
    }
  }
}
